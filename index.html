<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Color Picker — T-Shirt Letter Preview</title>

<link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@400;700&display=swap" rel="stylesheet" />

<style>
  :root{ --content-max: 640px; }
  *{ box-sizing: border-box; }
  body{
    font-family:'League Spartan',sans-serif;
    background:#fafafa; color:#333;
    margin:0; padding:24px;
    display:grid; place-items:start center;
  }
  .wrap{ width:100%; max-width:var(--content-max); }
  h1{
    text-align:center; font-weight:700;
    margin:8px 0 24px; font-size:clamp(20px,3.5vw,34px);
  }
  #picker{ margin:0 auto; } /* size via JS */

  #selectedColor{
    margin-top:20px; text-align:center; font-weight:700;
    font-size:clamp(16px,2.6vw,22px); word-break:break-word;
  }

  #copyRow{ margin-top:10px; text-align:center; }
  #copyBtn{
    font-family:'League Spartan',sans-serif;
    padding:10px 14px; border-radius:10px; border:2px solid #222;
    background:#fff; cursor:pointer; font-weight:700;
    transition:transform .06s ease, box-shadow .2s ease;
    box-shadow:0 2px 8px rgba(0,0,0,.06);
  }
  #copyBtn:active{ transform:translateY(1px); }
  #copyMsg{ margin-left:8px; font-weight:700; }

  /* T-shirt preview */
  #previewWrap{
    margin-top:14px; display:flex; justify-content:center;
  }
  #tee{
    filter: drop-shadow(0 6px 14px rgba(0,0,0,.12));
    /* width/height set by JS */
  }

  #warning{
    margin:14px auto 0; color:#b22222; font-weight:700;
    font-size:clamp(13px,2.2vw,17px); text-align:center; max-width:46ch; display:none;
  }

  @supports(padding:max(0px)){ body{ padding-bottom:max(24px, env(safe-area-inset-bottom)); } }
</style>
</head>
<body>

<div class="wrap">
  <h1>Choose your color</h1>

  <div id="picker" role="application" aria-label="Color picker"></div>

  <div id="selectedColor">Selected color: #FF5733</div>

  <div id="copyRow">
    <button id="copyBtn" type="button" aria-live="polite">Copy HEX</button>
    <span id="copyMsg" aria-hidden="true"></span>
  </div>

  <!-- T-shirt SVG preview (white tee + colored letter) -->
  <div id="previewWrap" aria-label="T-shirt color preview">
    <svg id="tee" viewBox="0 0 200 180" role="img" aria-label="T-shirt shape">
      <!-- Camiseta blanca -->
      <path id="teeFill"
        d="M60 12
           L90 26
           L110 26
           L140 12
           L180 52
           L153 70
           L153 160
           Q153 172 140 172
           L60 172
           Q47 172 47 160
           L47 70
           L20 52
           Z"
        fill="#FFFFFF" stroke="#222" stroke-width="3" stroke-linejoin="round" />
      <!-- cuello -->
      <path id="teeNeck" d="M85 28 Q100 40 115 28" fill="none" stroke="#222" stroke-width="3" stroke-linecap="round"/>
      <!-- Letra centrada que cambia de color -->
      <text id="teeLetter"
        x="100" y="110"
        text-anchor="middle"
        dominant-baseline="middle"
        font-family="League Spartan, system-ui, sans-serif"
        font-weight="700"
        font-size="64"
        fill="#FF5733">A</text>
    </svg>
  </div>

  <div id="warning">⚠️ This color is very light and may not be visible on white shirts. Consider using it on dark backgrounds.</div>
</div>

<!-- iro.js -->
<script src="https://cdn.jsdelivr.net/npm/@jaames/iro@5"></script>
<script>
  const INITIAL_COLOR = "#FF5733";

  const picker = new iro.ColorPicker('#picker', {
    width: 320, // reemplazado por sizePicker()
    borderWidth: 1,
    borderColor: "#ddd",
    layout: [
      { component: iro.ui.Wheel,  options: {} },
      { component: iro.ui.Slider, options: { sliderType: 'value' } }
    ],
    color: INITIAL_COLOR
  });

  const selectedColorText = document.getElementById('selectedColor');
  const warningText = document.getElementById('warning');
  const copyBtn = document.getElementById('copyBtn');
  const copyMsg = document.getElementById('copyMsg');
  const tee = document.getElementById('tee');
  const teeLetter = document.getElementById('teeLetter');

  // luminancia relativa (sRGB)
  function getLuminance(hex){
    const r = parseInt(hex.substr(1,2),16)/255;
    const g = parseInt(hex.substr(3,2),16)/255;
    const b = parseInt(hex.substr(5,2),16)/255;
    const a = [r,g,b].map(v=> v<=0.03928 ? v/12.92 : Math.pow((v+0.055)/1.055,2.4));
    return 0.2126*a[0] + 0.7152*a[1] + 0.0722*a[2];
  }

  // Actualiza UI
  let lastHex = INITIAL_COLOR;
  function updateUI(hex){
    lastHex = hex;
    selectedColorText.textContent = `Selected color: ${hex}`;
    teeLetter.setAttribute('fill', hex);

    const lum = getLuminance(hex);
    // Aviso si el color es muy claro (en camiseta blanca puede perderse)
    warningText.style.display = lum > 0.8 ? 'block' : 'none';
  }

  // Responsivo: rueda + camiseta + tamaño de la letra
  function sizePicker(){
    const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
    const maxContent = 640;
    const containerWidth = Math.min(vw - 48, maxContent); // body padding 24px por lado
    const wheelWidth = Math.max(220, Math.min(420, Math.floor(containerWidth * 0.85)));
    picker.resize(wheelWidth);

    // Escalar camiseta y letra
    const teeW = Math.round(wheelWidth * 0.6);
    const teeH = Math.round(wheelWidth * 0.45);
    tee.setAttribute('width', teeW);
    tee.setAttribute('height', teeH);

    // Letra ~40% del ancho de la camiseta
    teeLetter.setAttribute('font-size', Math.round(teeW * 0.4));
    // Asegurar que permanezca centrada:
    teeLetter.setAttribute('x', 100);
    teeLetter.setAttribute('y', 110);
  }

  // Debounce de resize
  let rAF;
  function onResize(){
    if (rAF) cancelAnimationFrame(rAF);
    rAF = requestAnimationFrame(sizePicker);
  }

  // Eventos
  picker.on('color:change', (color)=>{
    const hex = color.hexString.toUpperCase();
    updateUI(hex);
  });

  copyBtn.addEventListener('click', async ()=>{
    try{
      await navigator.clipboard.writeText(lastHex);
      copyMsg.textContent = 'Copied!';
      setTimeout(()=> copyMsg.textContent = '', 1500);
    }catch(e){
      alert('Could not copy. Please copy manually: ' + lastHex);
    }
  });

  window.addEventListener('resize', onResize);
  window.addEventListener('orientationchange', onResize);

  // Init
  sizePicker();
  updateUI(INITIAL_COLOR);
</script>
</body>
</html>
